<form [formGroup]="form" (submit)="save()">
  <mat-tab-group>
    <!-- GENERAL -->
    <mat-tab label="general">
      <div>
        <!-- start -->
        <mat-form-field style="width: 8em">
          <mat-label>start</mat-label>
          <input matInput [formControl]="start" />
          <mat-error
            *ngIf="start.errors?.required && (start.dirty || start.touched)"
            >start required</mat-error
          >
          <mat-error
            *ngIf="start.errors?.pattern && (start.dirty || start.touched)"
            >invalid start</mat-error
          >
        </mat-form-field>
        &nbsp;
        <!-- end -->
        <mat-form-field style="width: 8em">
          <mat-label>end</mat-label>
          <input matInput [formControl]="end" />
          <mat-error *ngIf="end.errors?.required && (end.dirty || end.touched)"
            >end required</mat-error
          >
          <mat-error *ngIf="end.errors?.pattern && (end.dirty || end.touched)"
            >invalid end</mat-error
          >
        </mat-form-field>
      </div>

      <div *ngIf="workEntries?.length">
        <cadmus-thesaurus-tree
          [entries]="$any(workEntries)"
          rootLabel="works"
          [renderLabel]="renderLabel"
          (entryChange)="onWorkEntryChange($event)"
        ></cadmus-thesaurus-tree>
      </div>
      <div>
        <!-- work -->
        <mat-form-field class="long-text">
          <mat-label>work</mat-label>
          <input matInput [formControl]="work" />
          <mat-error
            *ngIf="work.errors?.maxLength && (work.dirty || work.touched)"
            >too long</mat-error
          >
        </mat-form-field>
        &nbsp;
        <!-- location -->
        <mat-form-field>
          <mat-label>location</mat-label>
          <input matInput [formControl]="location" />
          <mat-error
            *ngIf="
              location.errors?.maxLength && (location.dirty || location.touched)
            "
            >too long</mat-error
          >
        </mat-form-field>
      </div>
      <div>
        <!-- title -->
        <mat-form-field class="long-text">
          <mat-label>title</mat-label>
          <input matInput [formControl]="title" />
          <mat-error
            *ngIf="title.errors?.maxLength && (title.dirty || title.touched)"
            >too long</mat-error
          >
        </mat-form-field>
      </div>
    </mat-tab>

    <!-- TEXT -->
    <mat-tab label="text">
      <div>
        <!-- incipit -->
        <mat-form-field class="long-text">
          <mat-label>incipit</mat-label>
          <textarea matInput [formControl]="incipit" rows="3"></textarea>
          <mat-error
            *ngIf="
              incipit.errors?.maxLength && (incipit.dirty || incipit.touched)
            "
            >too long</mat-error
          >
        </mat-form-field>
      </div>
      <div>
        <!-- explicit -->
        <mat-form-field class="long-text">
          <mat-label>explicit</mat-label>
          <textarea matInput [formControl]="explicit" rows="3"></textarea>
          <mat-error
            *ngIf="
              explicit.errors?.maxLength && (explicit.dirty || explicit.touched)
            "
            >too long</mat-error
          >
        </mat-form-field>
      </div>
      <div>
        <!-- note -->
        <mat-form-field class="long-text">
          <mat-label>note</mat-label>
          <textarea rows="3" matInput [formControl]="note"></textarea>
          <mat-error
            *ngIf="note.errors?.maxLength && (note.dirty || note.touched)"
            >note too long</mat-error
          >
        </mat-form-field>
      </div>
    </mat-tab>

    <!-- EDITIONS -->
    <mat-tab label="editions">
      <cadmus-refs-doc-references
        [typeEntries]="docTypeEntries"
        [tagEntries]="docTagEntries"
        [references]="initialEditions"
        (referencesChange)="onEditionsChange($event)"
      ></cadmus-refs-doc-references>
    </mat-tab>
  </mat-tab-group>

  <!-- buttons -->
  <div>
    <button
      type="button"
      color="warn"
      mat-icon-button
      matTooltip="Discard content changes"
      (click)="cancel()"
    >
      <mat-icon>clear</mat-icon>
    </button>
    <button
      type="submit"
      color="primary"
      mat-icon-button
      matTooltip="Accept content changes"
      [disabled]="form.invalid || form.pristine"
    >
      <mat-icon>check_circle</mat-icon>
    </button>
  </div>
</form>
